{{ template "layout-base.tmpl" . }}

{{ define "pageTitle" }}Cluster Info{{ end }}

{{ define "mainContent" }}
<main class="relative w-full h-full overflow-y-auto lg:ml-64 pb-8" x-data="clusterInfoComponent()">
  <div class="grid grid-cols-1 px-4 pt-6 xl:grid-cols-4 gap-2 xl:gap-4">

    <div class="mb-4 col-span-full xl:mb-2">
      <h1 class="text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white">Cluster Info</h1>
    </div>

    <div class="p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-xs col-span-full dark:border-gray-700 sm:p-6 dark:bg-gray-800">

      {{ template "loading" . }}
      <div x-show="!loading" x-cloak class="relative overflow-x-auto sm:rounded-lg">
        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-lg overflow-hidden">
          <thead class="bg-gray-100 dark:bg-gray-700">
            <tr>
              <th scope="col" class="px-4 py-3 text-xs font-medium tracking-wider text-left text-gray-600 uppercase dark:text-gray-300">Node</th>
              <th scope="col" class="px-4 py-3 text-xs font-medium tracking-wider text-left text-gray-600 uppercase dark:text-gray-300 hidden md:table-cell">Zone</th>
              <th scope="col" class="px-4 py-3 text-xs font-medium tracking-wider text-left text-gray-600 uppercase dark:text-gray-300 hidden lg:table-cell">Endpoint</th>
              <th scope="col" class="px-4 py-3 text-xs font-medium tracking-wider text-left text-gray-600 uppercase dark:text-gray-300 hidden sm:table-cell">Spaces</th>
              <th scope="col" class="px-4 py-3 text-xs font-medium tracking-wider text-left text-gray-600 uppercase dark:text-gray-300 hidden xl:table-cell">Runtimes</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
            <template x-if="nodes.length > 0">
              <template x-for="node in nodes" :key="node.id">
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-600/10">
                  <td class="px-4 py-3 text-gray-700 dark:text-gray-200">
                    <div class="text-sm font-semibold text-gray-900 dark:text-white" x-text="node.metadata.hostname || 'unknown'"></div>
                    <div class="text-xs text-gray-500 dark:text-gray-400 font-mono" x-text="node.id.substring(0, 8)"></div>
                    <div class="md:hidden mt-2 space-y-1">
                      <div class="text-sm">
                        <span class="font-medium">Zone:</span>
                        <span x-text="node.metadata.zone" class="text-gray-600 dark:text-gray-300"></span>
                      </div>
                    </div>
                    <div class="sm:hidden mt-2 space-y-1">
                      <div class="text-sm">
                        <span class="font-medium">Spaces:</span>
                        <span x-text="`${node.metadata.running_spaces || 0} / ${node.metadata.allocated_spaces || 0}`" class="text-gray-600 dark:text-gray-300"></span>
                      </div>
                    </div>
                    <div class="xl:hidden mt-2 space-y-1">
                      <template x-if="node.metadata.runtimes">
                        <div class="text-sm">
                          <span class="font-medium">Runtimes:</span>
                          <div class="flex flex-wrap gap-1 mt-1">
                            <template x-for="runtime in node.metadata.runtimes.split(',')" :key="runtime">
                              <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200" x-text="runtime"></span>
                            </template>
                          </div>
                        </div>
                      </template>
                    </div>
                  </td>
                  <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-200 hidden md:table-cell" x-text="node.metadata.zone"></td>
                  <td class="px-4 py-3 text-gray-700 dark:text-gray-200 hidden lg:table-cell">
                    <div class="text-sm font-mono text-gray-500 dark:text-gray-400" x-text="node.address"></div>
                  </td>
                  <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-200 hidden sm:table-cell">
                    <div class="text-sm">
                      <span class="font-medium" x-text="node.metadata.running_spaces || 0"></span>
                      <span class="text-gray-500 dark:text-gray-400">/</span>
                      <span x-text="node.metadata.allocated_spaces || 0"></span>
                    </div>
                    <div class="text-xs text-gray-500 dark:text-gray-400">running / total</div>
                  </td>
                  <td class="px-4 py-3 text-gray-700 dark:text-gray-200 hidden xl:table-cell">
                    <template x-if="node.metadata.runtimes">
                      <div class="flex flex-wrap gap-1">
                        <template x-for="runtime in node.metadata.runtimes.split(',')" :key="runtime">
                          <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200" x-text="runtime"></span>
                        </template>
                      </div>
                    </template>
                    <template x-if="!node.metadata.runtimes">
                      <span class="text-xs text-gray-400 dark:text-gray-500 italic">none</span>
                    </template>
                  </td>
                </tr>
              </template>
            </template>
          </tbody>
        </table>

      </div>

    </div>
  </div>
</main>
{{ end }}
